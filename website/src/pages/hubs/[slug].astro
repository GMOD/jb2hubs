---
import Layout from '../../layouts/Layout.astro'
import Container2 from '../../components/Container2.astro'
import ClientOnlyDataTable from '../../components/ClientOnlyDataTable.tsx'

export async function getStaticPaths() {
  const modules = import.meta.glob('../../../processedHubJson/*.json')
  const paths = await Promise.all(
    Object.entries(modules).map(async ([filepath, resolver]) => {
      const { default: data } = await resolver()
      const slug = filepath.split('/').pop().replace('.json', '')
      return slug !== 'all'
        ? {
            params: { slug },
            props: { rows: data },
          }
        : undefined
    }),
  )
  return paths.filter(f => !!f)
}

const { slug } = Astro.params
const { rows } = Astro.props

const title = slug.charAt(0).toUpperCase() + slug.slice(1)
---

<Layout title={`GenArk hubs - ${title}`}>
  <Container2>
    <div
      style="margin-bottom: 16px; display: flex; align-items: baseline; gap: 16px;"
    >
      <h1 style="margin: 0;">GenArk hubs - {title}</h1>
      <a
        href={`/taxonomy/${slug}`}
        style="color: #2563eb; text-decoration: underline;"
      >
        View taxonomy tree for {title}
      </a>
    </div>
    <ClientOnlyDataTable rows={rows} client:load />
  </Container2>
</Layout>
